# 09-离线阶段网站点击

## 1.网站点击流

```
点击流：是用户在网站上持续访问的轨迹。强调用户浏览网站的整体行为，比如访问的先后时间顺序可以串成一条线。
点击的数据来自web访问日志数据，只不过需要通过某种方式梳理成点击流模型数据。
总结：在梳理成点击流模型数据的时候，胡存在两种类型的数据类型pageviews,visits。
```

###  1.1 pageviews:模型

```
判断访问日志是否属于同一个session（根据ip判断同一个用户，根据前后两条日志时间相差是否在30分钟内） 属于同一session后，按照时间顺序标上步骤，这样就构成了一条访问轨迹（点击流）。
```

###  1.2 visits模型

```
主要侧重于体现用户在一次session中的进入离开时间，进入离开页面。还有统计出在本次session中用户总共访问了几个页面。
```

## 2 数据分析

```
 流量并不是越多越好，应该看重质量。让公司赚更多钱，好对业务进行开展工作，吸引客户。同时也能通过流量改善产品，对于内容分析。
 转化流程：其实就完成一个下单的流程。
 漏斗模型：根据转化流程，每一个流程的流量会逐级减少。然后对于没一个流程进行分析客户减少的原因。
```

##  3 流量指标

```
骨灰级指标：
	IP;一天之内，访问不重复IP数。
	页面浏览量：
	不 重复页面浏览量：一天内，访问网站的不重复用户数。只会记录1.
	
基础级指标：
	访问次数：一次session可能多个pv.
	网站停留时间：
	页面停留时间：
	
复合级指标：
	人均浏览页数：体现吸引程度
	跳出率：单页访问者与总访问次数的百分比。
	退出率：某一范围内退出的访问者与综合访问量的百分比。
```

## 4 整体技术流程

###  4.1数据处理流程

```
数据采集；数据预处理；数据入库；数据分析；数据展现。
```

### 4.2 系统架构

```

```

## 5.数据采集（Flume）

```
在生产过程中，为了控制日志大小，定时滚动。
```

###  5.1 TaildirSource

```
可以监控一个目录，并且使用正则表达式匹配目录中的文件名进行实时收集。
```

####  	5.1.1 核心配置

```
a1.sources = r1
a1.sources.r1.type = TAILDIR
a1.sources.r1.channels = c1
a1.sources.r1.positionFile = /var/log/flume/taildir_position.json
a1.sources.r1.filegroups = f1 f2
a1.sources.r1.filegroups.f1 = /var/log/test1/example.log
a1.sources.r1.filegroups.f2 = /var/log/test2/.*log.*
```

### 5.2 数据清洗

```
预处理阶段：需要过滤静态资源；过滤js/图片/css等静态资源
```
## 6 工作流调度器(Azkaban)

```
Azkaban 使用 job 配置文件建立任务之间的依赖关系，并提供一个易于使用的 web 用户界面维护和跟踪你的工作流。
```

###  6.1 启动 azkaban

```
当我们配置文件的路径是相对路径时候我们就必须到server文件目录下进行启动。
web 服务器
	在 azkaban web 服务器目录下执行启动命令
	bin/azkaban-web-start.sh
执行服务器
	在执行服务器目录下执行启动命令
	bin/azkaban-executor-start.sh ./
```