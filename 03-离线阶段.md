# 03-离线阶段

## 1.数据分析

```
	定义:指用适当的统计分析方法对收集来的数据进行分析,将它们加以汇总和理解并消化,以求最大的开发数据的功能,发挥数据的作用.
	作用:现状分析;;原因分析;预测分析.
```

### 1.1 用户行为理论

```
如:ip,pv,页面停留时间
```

### 1.2步骤

```
	明确分析目的和思路>数据收集>数据处理>数据分析>数据展示>报告撰写.
明确数据分析目的以及确定分析思路，是确保数据分析过程有效进行的先决条件，它可以为数据的收集、处理及分析提供清晰的指引方向。
```

## 2大数据分析系统

### 2.1模块

```
数据收集;数据存储;数据计算;数据分析;数据展示
```

### 2.2系统的意义

```
网站流量数据统计分析，可以帮助网站管理员、运营人员、推广人员等实时获取网站流量信息，并从流量来源、网站内容、网站访客特性等多方面提供网站分析的数据依据。从而帮助提高网站流量，提升网站用户体验，让访客更多的沉淀下来变成会员或客户，通过更少的投入获取最大化的收入。
终极目标是：
	改善网站的运营，获取更高投资回报率（ROI）。也就是赚更多的钱。
```

## 3.网站流量日志数据自定义采集

### 3.1 原理分析.

```
	首先，用户的行为会触发浏览器对被统计页面的一个 http 请求，比如打开某网页。当网页被打开，页面中的埋点 javascript 代码会被执行。
	埋点是指：在网页中预先加入小段 javascript 代码，这个代码片段一般会动态创建一个 script 标签，并将 src 属性指向一个单独的 js 文件，此时这个单独的 js 文件（图中绿色节点）会被浏览器请求到并执行，这个 js 往往就是真正的数据收集脚本。都是通过一些图片的形式.发送到后端.
	数据收集完成后，js 会请求一个后端的数据收集脚本（图中的 backend），这个脚本一般是一个伪装成图片的动态脚本程序，js 会将收集到的数据通过http 参数的方式传递给后端脚本，后端脚本解析参数并按固定格式记录到访问日志，同时可能会在 http 响应中给客户端种植一些用于追踪的 cookie。
	为了满足跨域的需求,一般采用请求一个图片的形式传递数据.响应也是一个图片(1*1像素的gif)
```
### 3.2  确定收集信息**

```
访问时间:可以通过Nginx获取.
;ip;域名;url;页面标题;浏览的客户端;...
可以通过javaScript,nginx,webServer

访问时间 web server 	Nginx $msec
IP web server 			Nginx $remote_addr
域名 javascript 			document.domain
URL javascript 			document.URL
页面标题 javascript		 document.title
分辨率 javascript 		window.screen.height & width
颜色深度 javascript 	window.screen.colorDepth
Referrer javascript 	document.referrer
浏览客户端 web server 	Nginx $http_user_agent
客户端语言 javascript 	navigator.language
访客标识 cookie Nginx 	$http_cookie
网站标识 javascript 	自定义对象
状态码 web server 		Nginx $status
发送内容量 web server 	Nginx $body_bytes_sent
```

### 3.3确定埋点代码

```

```